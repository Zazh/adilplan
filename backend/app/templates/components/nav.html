<nav class="fixed flex items-center w-full z-40 mt-4 px-3 md:px-0">
    <div class="m-auto max-w-[29rem] w-full bg-white px-3 md:px-6 md:py-3 flex justify-between items-center border-[1px] border-gray-200 rounded-full">
        <!-- Бургер -->
        <button id="burger-btn" class="sm:hidden flex items-center justify-center w-10 h-12" aria-label="Открыть меню" type="button">
            <svg id="burger-icon" class="w-6 h-6 block" fill="none" stroke="currentColor" stroke-width="2"
                 viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round"
                                           d="M4 6h16M4 12h16M4 18h16"/></svg>
            <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" stroke-width="2"
                 viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round"
                                           d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
        <div>
            <svg class="text-blue-900" width="28" height="30" viewBox="0 0 28 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.3732 17.3356C26.9539 16.3238 26.388 15.4422 25.674 14.6882C24.9587 13.9356 24.134 13.3313 23.1973 12.8738C22.2605 12.4178 21.2629 12.1891 20.2044 12.1891C18.8484 12.1891 17.8508 12.2917 16.9597 12.8129C16.0686 13.334 15.0682 14.2461 15.0682 14.2461V0H9.04368V0.518391H12.5084V9.55282C12.2621 9.42807 12.0061 9.31025 11.728 9.2063C10.8065 8.86394 9.6608 8.69207 8.29512 8.69207C7.16604 8.69207 6.16149 8.82651 5.28563 9.09403C4.40838 9.36154 3.68057 9.72746 3.10081 10.1876C2.52105 10.6492 2.08243 11.1787 1.78494 11.7733C1.48745 12.3693 1.3394 12.9944 1.3394 13.65C1.3394 14.2156 1.45839 14.6771 1.69638 15.0347C1.93299 15.391 2.54319 15.5698 3.52421 15.5698C4.08875 15.5698 4.52046 15.4298 4.81656 15.1456C5.11405 14.8629 5.26349 14.5136 5.26349 14.0964C5.26349 13.858 5.21921 13.4934 5.12927 13.0028C5.03934 12.5121 4.99506 12.0131 4.99506 11.5058C4.99506 10.7324 5.31469 10.1738 5.95394 9.83003C6.5932 9.48767 7.40265 9.3158 8.38367 9.3158C9.12671 9.3158 9.72168 9.42114 10.1672 9.62905C10.6128 9.83696 10.9545 10.1419 11.1925 10.5439C11.4291 10.9458 11.5938 11.4296 11.6823 11.9951C11.7709 12.5606 11.8166 13.201 11.8166 13.9162C11.8166 14.8102 11.7488 15.5171 11.6159 16.0383C11.4817 16.5594 11.2368 16.9919 10.8798 17.3342C10.5242 17.6766 10.0247 17.9663 9.38684 18.2047C8.74758 18.4431 7.93675 18.7259 6.95572 19.053C6.12414 19.3205 5.29808 19.5741 4.48172 19.8125C3.66397 20.0509 2.92093 20.3559 2.25124 20.7287C1.58292 21.1016 1.04052 21.6006 0.624036 22.2257C0.207551 22.8508 0 23.6852 0 24.7275C0 25.1739 0.0664163 25.6576 0.200633 26.1788C0.334849 26.6999 0.608816 27.1684 1.0253 27.5856C1.4404 28.0028 2.02016 28.3521 2.76458 28.6349C3.50761 28.9176 4.50385 29.059 5.75193 29.059C6.85195 29.059 7.75825 28.9329 8.47223 28.6792C9.1862 28.4256 9.75766 28.1137 10.1894 27.7409C10.6197 27.3694 10.9393 26.9813 11.1483 26.5793C11.3558 26.1774 11.5191 25.8433 11.6381 25.5744H11.7266C11.9646 26.6764 12.4032 27.533 13.0425 28.1428C13.4977 28.5781 14.1577 28.8553 15.0142 28.98C15.1042 29.0091 15.1941 29.0313 15.284 29.0466C15.284 29.0466 15.5068 29.0479 15.8514 29.0493C15.9468 29.0521 16.0409 29.0576 16.1405 29.0576C16.1917 29.0576 16.2374 29.0535 16.2858 29.0521C17.4799 29.059 19.3853 29.0701 19.9484 29.0687C21.083 29.0687 22.2121 28.786 23.2222 28.269C24.116 27.8116 24.9089 27.2142 25.5979 26.4768C26.3368 25.6881 26.9221 24.7802 27.3538 23.7559C27.7841 22.7316 28 21.6518 28 20.5167C28 19.3815 27.7911 18.3447 27.3718 17.3328L27.3732 17.3356ZM11.6823 21.9582C11.6823 22.5542 11.6298 23.2167 11.526 23.9458C11.4208 24.6763 11.2133 25.3527 10.9006 25.9778C10.5879 26.6029 10.1271 27.1241 9.51828 27.5413C8.90808 27.9585 8.11386 28.1678 7.13283 28.1678C6.4493 28.1678 5.89168 28.0486 5.46136 27.8102C5.02965 27.5718 4.6948 27.2668 4.45819 26.894C4.2202 26.5225 4.05693 26.0984 3.96837 25.6216C3.87843 25.1448 3.83416 24.6832 3.83416 24.2369C3.83416 23.1945 4.08599 22.3241 4.59241 21.6227C5.09745 20.9242 5.82526 20.3808 6.77723 19.9927L10.1216 18.6538C11.0431 18.2671 11.5329 17.879 11.5924 17.4922H11.6823V21.9582ZM24.1949 23.5743C24.1202 24.6236 23.9362 25.5176 23.64 26.2578C23.3439 26.9979 22.9012 27.5662 22.3103 27.9599C21.7195 28.3549 20.9184 28.5517 19.9083 28.5517C18.8982 28.5517 18.0417 28.33 17.4135 27.885C16.7853 27.4401 16.2983 26.8663 15.9537 26.1635C15.6078 25.4594 15.374 24.6763 15.2508 23.8127C15.1277 22.9492 15.0654 22.1093 15.0654 21.2956C15.0654 20.3337 15.0834 19.5007 15.1208 18.7965C15.1567 18.0924 15.2246 17.4701 15.3242 16.9267C15.4224 16.3848 15.5511 15.9149 15.7116 15.5199C15.8721 15.1248 16.0866 14.7547 16.3592 14.4096C16.7286 13.9162 17.2087 13.5087 17.8009 13.1885C18.3918 12.8683 19.1431 12.7075 20.055 12.7075C20.917 12.7075 21.6254 12.8808 22.1803 13.2259C22.7351 13.5724 23.1654 14.0645 23.474 14.7062C23.7812 15.348 23.997 16.1186 24.1202 17.0196C24.2433 17.9205 24.3056 18.9393 24.3056 20.0731C24.3056 21.3566 24.2682 22.5237 24.1949 23.5716V23.5743Z" fill="currentColor"/>
            </svg>
        </div>
        <a href="#" class="w-10 h-12 flex items-center justify-center md:hidden">
            <svg class="size-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2.00589 4.54166C1.905 3.11236 3.11531 2 4.54522 2H7.60606C8.34006 2 9.00207 2.44226 9.28438 3.1212L10.5643 6.19946C10.8761 6.94932 10.6548 7.81544 10.0218 8.32292L9.22394 8.96254C8.86788 9.24798 8.74683 9.74018 8.95794 10.1448C10.0429 12.2241 11.6464 13.9888 13.5964 15.2667C14.008 15.5364 14.5517 15.4291 14.8588 15.0445L15.6902 14.003C16.1966 13.3687 17.0609 13.147 17.8092 13.4594L20.8811 14.742C21.5587 15.0249 22 15.6883 22 16.4238V19.5C22 20.9329 20.8489 22.0955 19.4226 21.9941C10.3021 21.3452 2.65247 13.7017 2.00589 4.54166Z" fill="#000000"/>
            </svg>
        </a>
        <!-- Десктоп меню -->
        <ul class="gap-6 sm:flex hidden">
            {% for nav in nav_items %}
                <li><a href="#{{ nav.slug }}" class="hover:text-blue-900 text-gray-600 text-sm font-medium py-4">{{ nav.title }}</a></li>
            {% endfor %}
            <li><a href="#blog" class="hover:text-blue-900 text-gray-600 text-sm font-medium py-4">Блог</a></li>

        </ul>
        <!-- Мобильное меню -->
        <div id="mobile-menu" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
            <div id="mobile-menu-panel" class="bg-white w-3/4 max-w-xs h-full py-6 px-4 flex flex-col">
                {% for nav in nav_items %}
                    <li><a href="#{{ nav.slug }}" class="hover:text-blue-900 text-gray-600 text-base font-medium py-4">{{ nav.title }}</a></li>
                {% endfor %}
            </div>
            <div class="flex-1"></div>
        </div>
    </div>
</nav>

<script>
    const burgerBtn = document.getElementById('burger-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const burgerIcon = document.getElementById('burger-icon');
    const closeIcon = document.getElementById('close-icon');
    const menuPanel = document.getElementById('mobile-menu-panel');

    // Открыть меню
    function openMenu() {
        mobileMenu.classList.remove('hidden');
        burgerIcon.classList.add('hidden');
        closeIcon.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    // Закрыть меню
    function closeMenu() {
        mobileMenu.classList.add('hidden');
        burgerIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
        document.body.style.overflow = '';
    }

    // Клик по бургеру
    burgerBtn.addEventListener('click', (e) => {
        e.stopPropagation(); // Чтобы не всплывал на document
        if (mobileMenu.classList.contains('hidden')) {
            openMenu();
        } else {
            closeMenu();
        }
    });

    // Клик по крестику (иконка)
    closeIcon.addEventListener('click', closeMenu);

    // Клик вне панели меню (т.е. по оверлею)
    mobileMenu.addEventListener('click', function(e) {
        // если клик по самой панели меню — НЕ закрывать
        if (!menuPanel.contains(e.target)) {
            closeMenu();
        }
    });

</script>